(window.webpackJsonp=window.webpackJsonp||[]).push([[137],{787:function(s,a,t){"use strict";t.r(a);var n=t(4),r=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"什么是skywalking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是skywalking"}},[s._v("#")]),s._v(" 什么是Skywalking")]),s._v(" "),t("h3",{attrs:{id:"skywalking概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#skywalking概述"}},[s._v("#")]),s._v(" Skywalking概述")]),s._v(" "),t("p",[s._v("根据官方的解释，Skywalking是一个可观测性分析平台（Observability Analysis Platform简称OAP）  和应用性能管理系统（Application Performance Management简称APM）。")]),s._v(" "),t("p",[s._v("提供分布式链路追踪、服务网格(Service Mesh)遥测分析、度量(Metric)聚合和可视化一体化解决方案。  下面是Skywalking的几大特点：")]),s._v(" "),t("ul",[t("li",[s._v("多语言自动探针，Java，.NET Core和Node.JS。")]),s._v(" "),t("li",[s._v("多种监控手段，语言探针和service mesh。")]),s._v(" "),t("li",[s._v("轻量高效。不需要额外搭建大数据平台。")]),s._v(" "),t("li",[s._v("模块化架构。UI、存储、集群管理多种机制可选。")]),s._v(" "),t("li",[s._v("支持告警。")]),s._v(" "),t("li",[s._v("优秀的可视化效果。")])]),s._v(" "),t("p",[t("strong",[s._v("Skywalking整体架构如下：")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081814.png",alt:""}})]),s._v(" "),t("p",[s._v("Skywalking提供Tracing和Metrics数据的获取和聚合。")]),s._v(" "),t("blockquote",[t("p",[s._v("Metric的特点是，它是可累加的：他们具有原子性，每个都是一个逻辑计量单元，或者一个时间  段内的柱状图。 例如：队列的当前深度可以被定义为一个计量单元，在写入或读取时被更新统  计； 输入HTTP请求的数量可以被定义为一个计数器，用于简单累加； 请求的执行时间可以被定  义为一个柱状图，在指定时间片上更新和统计汇总。")]),s._v(" "),t("p",[s._v("Tracing的最大特点就是，它在单次请求的范围内，处理信息。 任何的数据、元数据信息都被绑定  到系统中的单个事务上。 例如：一次调用远程服务的RPC执行过程；一次实际的SQL查询语句；  一次HTTP请求的业务性ID。")]),s._v(" "),t("p",[s._v("总结，Metric主要用来进行数据的统计，比如HTTP请求数的计算。Tracing主要包含了某一次请  求的链路数据。")]),s._v(" "),t("p",[s._v("详细的内容可以查看Skywalking开发者吴晟翻译的文章，Metrics, tracing 和 logging 的关系 ：  http://blog.oneapm.com/apm-tech/811.html")])]),s._v(" "),t("p",[t("strong",[s._v("整体架构包含如下三个组成部分：")])]),s._v(" "),t("ol",[t("li",[s._v("探针(agent)负责进行数据的收集，包含了Tracing和Metrics的数据，agent会被安装到服务所在的  服务器上，以方便数据的获取。")]),s._v(" "),t("li",[s._v("可观测性分析平台OAP(Observability Analysis Platform)，接收探针发送的数据，并在内存中使  用分析引擎（Analysis Core)进行数据的整合运算，然后将数据存储到对应的存储介质上，比如  Elasticsearch、"),t("a",{attrs:{href:"https://cloud.tencent.com/product/cdb?from=10680",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL"),t("OutboundLink")],1),s._v("数据库、H2数据库等。同时OAP还使用查询引擎(Query Core)提供HTTP查  询接口。")]),s._v(" "),t("li",[s._v("Skywalking提供单独的UI进行数据的查看，此时UI会调用OAP提供的接口，获取对应的数据然后  进行展示。")])]),s._v(" "),t("h3",{attrs:{id:"skywalking优势"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#skywalking优势"}},[s._v("#")]),s._v(" Skywalking优势")]),s._v(" "),t("p",[s._v("Skywalking相比较其他的分布式链路监控工具，具有以下特点：")]),s._v(" "),t("ul",[t("li",[s._v("社区相当活跃。Skywalking已经进入apache孵化，目前的start数已经超过11K，最新版本6.5.0已  经发布。开发者是国人，可以直接和项目发起人交流进行问题的解决。")]),s._v(" "),t("li",[s._v("Skywalking支持Java，.NET Core和Node.JS语言。相对于其他平台：比如Pinpoint支持Java和  PHP,具有较大的优势。")]),s._v(" "),t("li",[s._v("探针无倾入性。对比CAT具有倾入性的探针，优势较大。不修改原有项目一行代码就可以进行集  成。")]),s._v(" "),t("li",[s._v("探针性能优秀。有网友对Pinpoint和Skywalking进行过测试，由于Pinpoint收集的数据过多，所以  对性能损耗较大，而Skywalking探针性能十分出色。")]),s._v(" "),t("li",[s._v("支持组件较多。特别是对Rpc框架的支持，这是其他框架所不具备的。Skywalking对Dubbo、  gRpc等有原生的支持，甚至连小众的motan和sofarpc都支持。")])]),s._v(" "),t("h3",{attrs:{id:"skywalking主要概念介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#skywalking主要概念介绍"}},[s._v("#")]),s._v(" Skywalking主要概念介绍")]),s._v(" "),t("p",[s._v("使用如下案例来进行Skywalking主要概念的介绍，Skywalking主要概念包含：")]),s._v(" "),t("ul",[t("li",[s._v("服务(Service)")]),s._v(" "),t("li",[s._v("端点(Endpoint)")]),s._v(" "),t("li",[s._v("实例(Instance)")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081744.png",alt:""}})]),s._v(" "),t("p",[s._v("上图中，我们编写了用户服务，这是一个web项目，在生产中部署了两个节点：192.168.1.100和  192.168.1.101。")]),s._v(" "),t("ul",[t("li",[s._v("用户服务就是Skywalking的服务(Service)，用户服务其实就是一个独立的应用(Application)，在  6.0之后的Skywalking将应用更名为服务(Service)。")]),s._v(" "),t("li",[s._v("用户服务对外提供的HTTP接口/usr/queryAll就是一个端点，端点就是对外提供的接口。")]),s._v(" "),t("li",[s._v("192.168.1.100和192.168.1.101这两个相同服务部署的节点就是实例，实例指同一服务可以部署  多个。")])]),s._v(" "),t("h2",{attrs:{id:"环境搭建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境搭建"}},[s._v("#")]),s._v(" 环境搭建")]),s._v(" "),t("p",[s._v("接下来我们在虚拟机CentOS中搭建Skywalking的可观测性分析平台OAP环境。Skywalking默认使用H2  内存中进行数据的存储，我们可以替换存储源为ElasticSearch保证其查询的高效及可用性。")]),s._v(" "),t("blockquote",[t("p",[s._v("具体的安装步骤可以在Skywalking的官方github上找到:  https://github.com/apache/skywalking/blob/master/docs/en/setup/README.md")])]),s._v(" "),t("ol",[t("li",[s._v("创建目录")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("mkdir "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("建议将虚拟机内存设置为3G并且将CPU设置成2核，防止资源不足。  当前dev环境配置为2C4G,且apollo和skywalking公用集群,所以,  测试时请轻一点")])]),s._v(" "),t("ol",[t("li",[s._v("资源版本")])]),s._v(" "),t("blockquote",[t("p",[s._v("当前dev环境es版本为6.4.0, skywalking使用的是6.5.0.  搭建时请自行到官网下载")])]),s._v(" "),t("ol",[t("li",[s._v("首先安装elasticsearch，将压缩包解压。")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("tar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("zxvf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("elasticsearch"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.4")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("修改Linux系统的限制配置，将文件创建数修改为65536个。")]),s._v(" "),t("blockquote"),s._v(" "),t("ol",[t("li",[s._v("修改系统中允许应用最多创建多少文件等的限制权限。Linux默认来说，一般限制应用最多  创建的文件是65535个。但是ES至少需要65536的文件创建数的权限。")]),s._v(" "),t("li",[s._v("修改系统中允许用户启动的进程开启多少个线程。默认的Linux限制root用户开启的进程可  以开启任意数量的线程，其他用户开启的进程可以开启1024个线程。必须修改限制数为  4096+。因为ES至少需要4096的线程池预备。")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("vi "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("security"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("limits"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n\n#新增如下内容在limits"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf文件中\nes soft nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\nes hard nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\nes soft nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\nes hard nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("修改系统控制权限，ElasticSearch需要开辟一个65536字节以上空间的虚拟内存。Linux默认不允许任  何用户和应用程序直接开辟这么大的虚拟内存。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("vi "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sysctl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n#新增如下内容在sysctl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf文件中，当前用户拥有的内存权限大小\nvm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("max_map_count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("262144")]),s._v("\n\n#让系统控制权限配置生效\nsysctl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("建一个用户， 用于ElasticSearch启动。")]),s._v(" "),t("blockquote",[t("p",[s._v("ES在5.x版本之后，强制要求在linux中不能使用root用户启动ES进程。所以必须使用其他用户启  动ES进程才可以。")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("#创建用户\nuseradd es\n#修改上述用户的密码\npasswd es\n#创建密码记得不能太过简单\n#修改elasicsearch目录的拥有者\nchown "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("R")]),s._v(" es elasticsearch"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.4")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("blockquote",[t("p",[s._v("当前dev环境可以直接使用以下非root账户  账号: appdeploy  密码: BrysjHhrhl!@12")])]),s._v(" "),t("p",[s._v("使用es用户启动elasticsearch")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("#切换用户\nsu es\n#到ElasticSearch的bin目录下\ncd bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n#后台启动\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("elasticsearch "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("默认ElasticSearch是不支持跨域访问的，所以在不修改配置文件的情况下我们只能从虚拟机内部进行访  问测试ElasticSearch是否安装成功，使用curl命令访问9200端口：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("curl http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果显示出如下信息，就证明ElasticSearch安装成功：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xbruNxf"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('\n\t"cluster\n\t_\n\tname '),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" : "')]),s._v('\n\telasticsearch "'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('\n\t"cluster\n\t_uuid '),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" : "')]),s._v('\n\tJJQfHN9QQVuXpH5fu9H1jg "'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"number"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6.4.0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('\n\t\t"build_\n\t\tflavor '),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" : "')]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(' "'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"build_type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tar"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('\n\t\t"build_\n\t\thash '),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" : "')]),s._v('\n\t\t595516e "'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"build_date"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018-08-17T23:18:47.308994Z"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"build_snapshot"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('\n\t\t"lucene_\n\t\tversion '),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" : "')]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v(' "'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('\n\t\t"minimum\n\t\t_\n\t\twire_compatibility_\n\t\tversion '),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" : "')]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.6")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v(' "'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v('\n\t\t"minimum\n\t\t_\n\t\tindex\n\t\t_compatibility_\n\t\tversion '),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" : "')]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v(' "\n\t'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"tagline"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You Know, for Search"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("p",[s._v("4、安装Skywalking，分为两个步骤：")]),s._v(" "),t("ul",[t("li",[s._v("安装Backend后端服务")]),s._v(" "),t("li",[s._v("安装UI")])]),s._v(" "),t("p",[s._v("首先切回到root用户,切换到目录下，解压Skywalking压缩包。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("#切换到root用户\nsu root\n#切换到skywalking目录\ncd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking\n#解压压缩包\ntar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("zxvf apache"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("apm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.4")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("修改Skywalking存储的数据源配置：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("cd apache"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("apm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bin\nvi config"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("application"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yml\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("我们可以看到默认配置中，使用了H2作为数据源。我们将其全部注释。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081711.png",alt:""}})]),s._v(" "),t("p",[s._v("将ElasticSearch对应的配置取消注释：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("storage")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("elasticsearch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("nameSpace")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_NAMESPACE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("clusterNodes")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_CLUSTER_NODES")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("protocol")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_HTTP_PROTOCOL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("trustStorePath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_SW_STORAGE_ES_SSL_JKS_PATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"../es_keystore.jks"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("trustStorePass")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_SW_STORAGE_ES_SSL_JKS_PASS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_ES_USER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_ES_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("indexShardsNumber")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_INDEX_SHARDS_NUMBER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("indexReplicasNumber")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_INDEX_REPLICAS_NUMBER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    # Those data "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TTL")]),s._v(" settings will override the same settings "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" core module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("recordDataTTL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_RECORD_DATA_TTL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" # Unit is day\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("otherMetricsDataTTL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_OTHER_METRIC_DATA_TTL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" # Unit is day\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("monthMetricsDataTTL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_MONTH_METRIC_DATA_TTL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" # Unit is month\n    # Batch process setting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" refer to https"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("elastic"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("co"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("guide"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("en"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("elasticsearch"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("client"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("java"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("api"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.5")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("java"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("docs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bulk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("processor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("bulkActions")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_BULK_ACTIONS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" # Execute the bulk every "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" requests\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("flushInterval")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_FLUSH_INTERVAL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" # flush the bulk every "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" seconds whatever the number "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("of")]),s._v(" requests\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("concurrentRequests")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_CONCURRENT_REQUESTS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" # the number "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("of")]),s._v(" concurrent requests\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("resultWindowMaxSize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_QUERY_MAX_WINDOW_SIZE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("metadataQueryMaxSize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_QUERY_MAX_SIZE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("segmentQueryMaxSize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_STORAGE_ES_QUERY_SEGMENT_SIZE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("默认使用了localhost下的ES,所以我们可以不做任何处理，直接进行使用。启动OAP程序：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oapService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这样安装Backend后端服务就已经完毕了，接下来我们安装UI。先来看一下UI的配置文件：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("cat webapp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("webapp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yml\n#默认启动端口\n"),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("collector")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("graphql\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("ribbon")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("ReadTimeout")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n    #"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OAP")]),s._v("服务，如果有多个用逗号隔开\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("listOfServers")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("目前的默认配置不用修改就可以使用，启动UI程序：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("webappService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后我们就可以通过浏览器访问Skywalking的可视化页面了，访问地址:http://虚拟机IP地址:8080,如果  出现下面的图，就代表安装成功了。")]),s._v(" "),t("blockquote",[t("p",[s._v("/bin/startup.sh可以同时启动backend和ui，后续可以执行该文件进行重启。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081622.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"skywalking基础"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#skywalking基础"}},[s._v("#")]),s._v(" Skywalking基础")]),s._v(" "),t("h3",{attrs:{id:"agent的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#agent的使用"}},[s._v("#")]),s._v(" agent的使用")]),s._v(" "),t("p",[s._v("agent探针可以让我们不修改代码的情况下，对java应用上使用到的组件进行动态监控，获取运行数据  发送到OAP上进行统计和存储。agent探针在java中是使用java agent技术实现的，不需要更改任何代  码，java agent会通过虚拟机(VM)接口来在运行期更改代码。")]),s._v(" "),t("p",[s._v("Agent探针支持 JDK 1.6 - 12的版本，Agent探针所有的文件在Skywalking的agent文件夹下。文件目录  如下；")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" agent\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" activations\napm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("toolkit"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("log4j"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("activation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\napm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("toolkit"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("log4j"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("activation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\napm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("toolkit"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("logback"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("activation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" config\nagent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("config\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//组件的所有插件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" plugins\napm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dubbo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\napm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("feign"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\napm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("httpClient"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//可选插件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" optional"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugins\napm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gson"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" bootstrap"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugins\njdk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" logs\nskywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("agent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("blockquote",[t("p",[s._v("部分插件在使用上会影响整体的性能或者由于版权问题放置于可选插件包中，不会直接加载，如  果需要使用，将可选插件中的jar包拷贝到plugins包下。")])]),s._v(" "),t("p",[s._v("由于没有修改agent探针中的应用名，所以默认显示的是Your_ApplicationName。我们修改下应用名  称，让他显示的更加正确。编辑agent配置文件：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("cd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("apache"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("apm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("agent"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("config\nvi agent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("config\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("我们在配置中找到这么一行：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("# The service name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UI")]),s._v("\nagent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_AGENT_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("application_springboot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("这里的配置含义是可以读取到SW_AGENT_NAME配置属性，如果该配置没有指定，那么默认名称为  Your_ApplicationName。这里我们把Your_ApplicationName替换成skywalking_tomcat。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("# The service name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UI")]),s._v("\nagent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_AGENT_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("skywalking_tomcat"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后将tomcat重启:")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("shutdown"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("startup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"linux-下tomcat7和8中使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-下tomcat7和8中使用"}},[s._v("#")]),s._v(" Linux 下Tomcat7和8中使用")]),s._v(" "),t("p",[s._v("1.要使用Skywalking监控Tomcat中的应用，需要先准备一个Spring Mvc项目，在资源中已经提供了打  包好的文件")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("devops"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking_springboot"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking_springmvc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SNAPSHOT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("war\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("以下是该项目的接口代码：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("saas"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("controller"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stereotype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Controller"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("RequestMapping"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ResponseBody"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n@Controller\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/hello"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//hello/sayHello.do")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HelloController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    @"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/sayHello"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    @ResponseBody\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" String "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sayHello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("String name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("tomcat采用的是8.5.47版本, 请自行安装, 这里不做展示")]),s._v(" "),t("p",[s._v("将war包上传至/usr/local/skywalking/apache-tomcat-8.5.47/webapps/下。编  辑 /usr/local/skywalking/apache-tomcat-8.5.47/bin/catalina.sh 文件，在文件顶部添加：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CATALINA_OPTS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$CATALINA_OPTS -javaagent:/usr/local/skywalking/apache�skywalking-apm-bin/agent/skywalking-agent.jar"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CATALINA_OPTS")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("修改tomcat启动端口：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("vi conf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xml\n#修改这一行的端口为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Connector port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8080"')]),s._v(" protocol"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("执行bin目录下的./startup.sh 文件启动tomcat。然后访问地址：  http://虚拟机IP:8081/skywalking_springmvc-1.0-SNAPSHOT/hello/sayHello.do")]),s._v(" "),t("p",[s._v("如果正确打开，能输出hello world。")]),s._v(" "),t("blockquote",[t("p",[s._v("注意：一定要保证虚拟机和物理机的时间一致，否则访问数据的时候会因为时间不一致而获取不  到数据。")])]),s._v(" "),t("p",[s._v("此时再访问Skywalking的页面，会发现出现了一个服务和端点，同时有一笔调用显示了调用的应用名和  接口地址。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081604.png",alt:""}})]),s._v(" "),t("p",[s._v("由于没有修改agent探针中的应用名，所以默认显示的是Your_ApplicationName。接下来我们修改下应  用名称，让他显示的更加正确。编辑agent配置文件：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("cd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("apache"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("apm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("agent"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("config\nvi agent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("config\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("我们在配置中找到这么一行：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("# The service name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UI")]),s._v("\nagent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_AGENT_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("application_springboot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("这里的配置含义是可以读取到SW_AGENT_NAME配置属性，如果该配置没有指定，那么默认名称为  Your_ApplicationName。这里我们把Your_ApplicationName替换成skywalking_tomcat。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("# The service name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UI")]),s._v("\nagent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_AGENT_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("skywalking_tomcat"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后将tomcat重启:")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("shutdown"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("startup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081527.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"windows-下tomcat7和8中使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-下tomcat7和8中使用"}},[s._v("#")]),s._v(" Windows 下Tomcat7和8中使用")]),s._v(" "),t("p",[s._v("Windows下只需要修改f tomcat目录/bin/catalina.bat 文件的第一行为：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CATALINA_OPTS=-javaagent:/path/to/skywalking-agent/skywalking-agent.jar"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"spring-boot中使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot中使用"}},[s._v("#")]),s._v(" Spring Boot中使用")]),s._v(" "),t("p",[s._v("Skywalking与Spring Boot集成提供了完善的支持。")]),s._v(" "),t("ol",[t("li",[s._v("首先我们复制一份agent，防止与tomcat使用的冲突。")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("cd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("apache"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("apm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\ncp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r agent agent_boot\nvi agent_boot"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("agent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("config\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("修改配置中的应用名为：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("# The service name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UI")]),s._v("\nagent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SW_AGENT_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("skywalking_springboot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("2.将资源文件夹中 skywalking_springboot.jar 文件上传到 /usr/local/skywalking 目录下。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("devops"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking_springboot"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking_springboot"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SNAPSHOT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("Controller层代码如下，提供了一个正常访问的接口和一个异常访问接口：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("saas"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("skywalking_springboot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("controller"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("RequestMapping"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("RestController"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n@RestController\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MyController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//正常访问接口")]),s._v("\n    @"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/sayBoot"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" String "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sayBoot")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello Boot!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//异常访问接口")]),s._v("\n    @"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/exception"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" String "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exception")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        int i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello Boot!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[s._v("使用命令启动spring boot项目:")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("java "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("javaagent"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("apache"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("apm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("agent_boot"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("skywalking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("agent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Dserver"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8082")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("jar skywalking_springboot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("使用jar包启动的项目如果需要集成skywalking，需要添加-javaagent参数，参数值为agent的jar  包梭子啊位置。")]),s._v(" "),t("p",[s._v("-Dserver.port参数用于指定端口号，防止与tomcat冲突。")]),s._v(" "),t("p",[s._v("末尾添加 & 后台运行模式启动Spring Boot项目。  此时我们可以访问http://虚拟机IP:8082/sayBoot地址来进行访问，访问之后稍等片刻访问Skywalking  的UI页面。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081511.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"rocketbot的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rocketbot的使用"}},[s._v("#")]),s._v(" RocketBot的使用")]),s._v(" "),t("p",[s._v("Skywalking的监控UI页面称为RocketBot，我们可以通过 8080 端口进行访问， 由于8080端口很容易冲  突，可以修改 webapp/webapp.yml 来更改启动端口：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("本例中我们更改为9010端口防止冲突。访问http://虚拟机IP:9010/打开RocketBot的页面。")]),s._v(" "),t("h3",{attrs:{id:"仪表盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#仪表盘"}},[s._v("#")]),s._v(" 仪表盘")]),s._v(" "),t("p",[s._v("打开RocketBot默认会出现仪表盘页面：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081455.png",alt:""}})]),s._v(" "),t("p",[s._v("仪表盘页面分为两大块：")]),s._v(" "),t("ul",[t("li",[s._v("服务仪表盘，展示服务的调用情况")]),s._v(" "),t("li",[s._v("数据库仪表盘，展示数据库的响应时间等数据")])]),s._v(" "),t("p",[s._v("选中服务仪表盘，有四个维度的统计数据可以进行查看：")]),s._v(" "),t("ul",[t("li",[s._v("全局，查看全局接口的调用，包括全局响应时长的百分比，最慢的端点，服务的吞吐量等")]),s._v(" "),t("li",[s._v("服务，显示服务的响应时长、SLA、吞吐量等信息")]),s._v(" "),t("li",[s._v("端点，显示端点的响应时长、SLA、吞吐量等信息")]),s._v(" "),t("li",[s._v("实例，显示实例的响应时长、SLA、吞吐量等信息，还可以查看实例的JVM的GC信息、CPU信息、  内存信息")])]),s._v(" "),t("h3",{attrs:{id:"拓扑图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拓扑图"}},[s._v("#")]),s._v(" 拓扑图")]),s._v(" "),t("p",[s._v("Skywalking提供拓扑图，直观的查看服务之间的调用关系：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081441.png",alt:""}})]),s._v(" "),t("blockquote",[t("p",[s._v("User代表用户应用，目前案例中其实是浏览器")])]),s._v(" "),t("p",[s._v("图中Skywalking_boot应用被User调用，同时显示它是一个Spring MVC的应用。后续案例中会出现多个  应用调用，使用拓扑图就能清楚的分析其调用关系了。")]),s._v(" "),t("h3",{attrs:{id:"追踪"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#追踪"}},[s._v("#")]),s._v(" 追踪")]),s._v(" "),t("p",[s._v("在Skywalking中，每一次用户发起一条请求，就可以视为一条追踪数据，每条追踪数据携带有一个ID  值。追踪数据在追踪页面中可以进行查询：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081429.png",alt:""}})]),s._v(" "),t("p",[s._v("左侧是追踪列表，也可以通过上方的追踪ID来进行查询。点击追踪列表某一条记录之后，右侧会显示出  此条追踪的详细信息。有三种显示效果：")]),s._v(" "),t("ul",[t("li",[s._v("列表")]),s._v(" "),t("li",[s._v("树结构")]),s._v(" "),t("li",[s._v("表格")])]),s._v(" "),t("p",[s._v("可以很好的展现此条追踪的调用链情况而链路上每个节点，可以通过左键点击节点查看详细信息：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200815081405.png",alt:""}})]),s._v(" "),t("p",[s._v("当前的接口是HTTP的GET请求，相对比较简单，后续的示例中出现异常情况或者数据库访问，可以打印  出异常信息、堆栈甚至详细的SQL语句。")]),s._v(" "),t("h3",{attrs:{id:"告警"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#告警"}},[s._v("#")]),s._v(" 告警")]),s._v(" "),t("p",[s._v("Skywalking中的告警功能相对比较简单，在达到告警阈值之后会生成一条告警记录，在告警页面上进行展示。")])])}),[],!1,null,null,null);a.default=r.exports}}]);