(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{769:function(t,a,n){"use strict";n.r(a);var s=n(4),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"_1-关于prometheus"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-关于prometheus"}},[t._v("#")]),t._v(" 1.关于Prometheus")]),t._v(" "),n("p",[t._v("Prometheus是一个根据应用的metrics来进行监控的开源工具。相信很多工程都在使用它来进行监控，有关详细介绍可以查看官网：https://prometheus.io/docs/introduction/overview/。")]),t._v(" "),n("h2",{attrs:{id:"_2-有关grafana"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-有关grafana"}},[t._v("#")]),t._v(" 2.有关Grafana")]),t._v(" "),n("p",[t._v("Grafana是一个开源监控利器，如图所示。")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.loli.net/2020/01/08/3ySt4DQXFZ5HUMe.png",alt:""}})]),t._v(" "),n("p",[t._v("从图中就可以看出来，使用Grafana监控很高大上，提供了很多可视化的图标。")]),t._v(" "),n("p",[t._v("官网地址：https://grafana.com/")]),t._v(" "),n("h2",{attrs:{id:"_3-springboot使用prometheus"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-springboot使用prometheus"}},[t._v("#")]),t._v(" 3.SpringBoot使用Prometheus")]),t._v(" "),n("h3",{attrs:{id:"_3-1-依赖内容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-依赖内容"}},[t._v("#")]),t._v(" 3.1 依赖内容")]),t._v(" "),n("p",[t._v("在SpringBoot中使用Prometheus其实很简单，不需要配置太多的东西，在pom文件中加入依赖，完整内容如下所示。")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\nxsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n<modelVersion>4.0.0</modelVersion>\n<parent>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-parent</artifactId>\n\t<version>2.1.3.RELEASE</version>\n\t<relativePath/> \x3c!-- lookup parent from repository --\x3e\n</parent>\n<groupId>com.dalaoyang</groupId>\n<artifactId>springboot2_prometheus</artifactId>\n<version>0.0.1-SNAPSHOT</version>\n<name>springboot2_prometheus</name>\n<description>springboot2_prometheus</description>\n\n<properties>\n\t<java.version>1.8</java.version>\n</properties>\n\n<dependencies>\n\t<dependency>\n\t\t<groupId>org.springframework.boot</groupId>\n\t\t<artifactId>spring-boot-starter-actuator</artifactId>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>org.springframework.boot</groupId>\n\t\t<artifactId>spring-boot-starter-web</artifactId>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>org.springframework.boot</groupId>\n\t\t<artifactId>spring-boot-starter-test</artifactId>\n\t\t<scope>test</scope>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>io.micrometer</groupId>\n\t\t<artifactId>micrometer-registry-prometheus</artifactId>\n\t\t<version>1.1.3</version>\n\t</dependency>\n</dependencies>\n<build>\n\t<plugins>\n\t\t<plugin>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-maven-plugin</artifactId>\n\t\t</plugin>\n\t</plugins>\n</build>\n</project>\n')])])]),n("h3",{attrs:{id:"_3-2-配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-配置文件"}},[t._v("#")]),t._v(" 3.2 配置文件")]),t._v(" "),n("p",[t._v("配置文件中加入配置，这里就只进行一些简单配置，management.metrics.tags.application属性是本文配合Grafana的Dashboard设置的，如下所示：")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("spring.application.name=springboot_prometheus\nmanagement.endpoints.web.exposure.include=*\nmanagement.metrics.tags.application=${spring.application.name}\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("h3",{attrs:{id:"_3-3-设置application"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-设置application"}},[t._v("#")]),t._v(" 3.3 设置application")]),t._v(" "),n("p",[t._v("修改启动类，如下所示.")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('@SpringBootApplication\npublic class Springboot2PrometheusApplication {\n\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(Springboot2PrometheusApplication.class, args);\n\t}\n\t@Bean\n\tMeterRegistryCustomizer<MeterRegistry> configurer(\n\t\t\t@Value("${spring.application.name}") String applicationName) {\n\t\treturn (registry) -> registry.config().commonTags("application", applicationName);\n\t}\n}\n\n')])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br")])]),n("p",[t._v("SpringBoot项目到这里就配置完成了，启动项目，访问http://localhost:8080/actuator/prometheus，如图所示，可以看到一些度量指标。")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.loli.net/2020/01/09/boVx1JihclruWzv.png",alt:""}})]),t._v(" "),n("h2",{attrs:{id:"_4-prometheus配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-prometheus配置"}},[t._v("#")]),t._v(" 4.Prometheus配置")]),t._v(" "),n("h3",{attrs:{id:"_4-1-配置应用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-配置应用"}},[t._v("#")]),t._v(" 4.1 配置应用")]),t._v(" "),n("p",[t._v("在prometheus配置监控我们的SpringBoot应用，完整配置如下所示。")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("# my global config\nglobal:\n  scrape_interval:     15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.\n  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.\n  # scrape_timeout is set to the global default (10s).\n\n# Alertmanager configuration\nalerting:\n  alertmanagers:\n  - static_configs:\n    - targets:\n      # - alertmanager:9093\n\n# Load rules once and periodically evaluate them according to the global 'evaluation_interval'.\nrule_files:\n  # - \"first_rules.yml\"\n  # - \"second_rules.yml\"\n\n# A scrape configuration containing exactly one endpoint to scrape:\n# Here it's Prometheus itself.\nscrape_configs:\n  - job_name: 'prometheus'\n    static_configs:\n    - targets: ['127.0.0.1:9090']\n###以下内容为SpringBoot应用配置\n  - job_name: 'springboot_prometheus'\n    scrape_interval: 5s\n    metrics_path: '/actuator/prometheus'\n    static_configs:\n      - targets: ['127.0.0.1:8080']\n\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br")])]),n("h3",{attrs:{id:"_4-2-启动prometheus"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-启动prometheus"}},[t._v("#")]),t._v(" 4.2 启动Prometheus")]),t._v(" "),n("p",[t._v("启动Prometheus，浏览器访问，查看Prometheus页面。")]),t._v(" "),n("p",[t._v("可以查看Prometheus监控的应用。")]),t._v(" "),n("h2",{attrs:{id:"_5-grafana配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-grafana配置"}},[t._v("#")]),t._v(" 5.Grafana配置")]),t._v(" "),n("p",[t._v("启动Grafana，配置Prometheus数据源，这里以ID是4701的Doshboard为例（地址：https://grafana.com/dashboards/4701）如图。")]),t._v(" "),n("p",[t._v("在Grafana内点击如图所示import按钮")]),t._v(" "),n("p",[t._v("在如图所示位置填写4701，然后点击load。")]),t._v(" "),n("p",[t._v("接下来导入Doshboard。")]),t._v(" "),n("p",[t._v("导入后就可以看到我们的SpringBoot项目对应的指标图表了。")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.loli.net/2020/01/08/ebCjVTKW6iINFkE.png",alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);