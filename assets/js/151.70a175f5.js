(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{808:function(s,a,e){"use strict";e.r(a);var n=e(4),r=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"nacos-spring-boot-快速开始"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nacos-spring-boot-快速开始"}},[s._v("#")]),s._v(" Nacos Spring Boot 快速开始")]),s._v(" "),e("p",[s._v("本文主要面向 Spring Boot 的使用者，通过两个示例来介绍如何使用 Nacos 来实现分布式环境下的配置管理和服务发现。")]),s._v(" "),e("p",[s._v("关于 Nacos Spring Boot 的详细文档请参看："),e("a",{attrs:{href:"https://github.com/nacos-group/nacos-spring-boot-project/wiki/spring-boot-0.2.2-%E4%BB%A5%E5%8F%8A-0.1.2%E7%89%88%E6%9C%AC%E6%96%B0%E5%8A%9F%E8%83%BD%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C",target:"_blank",rel:"noopener noreferrer"}},[s._v("nacos-spring-boot-project"),e("OutboundLink")],1),s._v("。")]),s._v(" "),e("ul",[e("li",[s._v("通过 Nacos Server 和 nacos-config-spring-boot-starter 实现配置的动态变更；")]),s._v(" "),e("li",[s._v("通过 Nacos Server 和 nacos-discovery-spring-boot-starter 实现服务的注册与发现。")])]),s._v(" "),e("h2",{attrs:{id:"前提条件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前提条件"}},[s._v("#")]),s._v(" 前提条件")]),s._v(" "),e("p",[s._v("您需要先下载 Nacos 并启动 Nacos server。操作步骤参见 "),e("a",{attrs:{href:"https://nacos.io/zh-cn/docs/quick-start.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos 快速入门"),e("OutboundLink")],1),s._v("。")]),s._v(" "),e("h2",{attrs:{id:"启动配置管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动配置管理"}},[s._v("#")]),s._v(" 启动配置管理")]),s._v(" "),e("p",[s._v("启动了 Nacos server 后，您就可以参考以下示例代码，为您的 Spring Boot 应用启动 Nacos 配置管理服务了。完整示例代码请参考："),e("a",{attrs:{href:"https://github.com/nacos-group/nacos-examples/tree/master/nacos-spring-boot-example/nacos-spring-boot-config-example",target:"_blank",rel:"noopener noreferrer"}},[s._v("nacos-spring-boot-config-example"),e("OutboundLink")],1)]),s._v(" "),e("ol",[e("li",[s._v("添加依赖。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<dependency>\n    <groupId>com.alibaba.boot</groupId>\n    <artifactId>nacos-config-spring-boot-starter</artifactId>\n    <version>${latest.version}</version>\n</dependency>\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("strong",[s._v("注意")]),s._v("：版本 "),e("a",{attrs:{href:"https://mvnrepository.com/artifact/com.alibaba.boot/nacos-config-spring-boot-starter",target:"_blank",rel:"noopener noreferrer"}},[s._v("0.2.x.RELEASE"),e("OutboundLink")],1),s._v(" 对应的是 Spring Boot 2.x 版本，版本 "),e("a",{attrs:{href:"https://mvnrepository.com/artifact/com.alibaba.boot/nacos-config-spring-boot-starter",target:"_blank",rel:"noopener noreferrer"}},[s._v("0.1.x.RELEASE"),e("OutboundLink")],1),s._v(" 对应的是 Spring Boot 1.x 版本。")]),s._v(" "),e("ol",[e("li",[s._v("在 "),e("code",[s._v("application.properties")]),s._v(" 中配置 Nacos server 的地址：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("nacos.config.server-addr=127.0.0.1:8848\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ol",[e("li",[s._v("使用 "),e("code",[s._v("@NacosPropertySource")]),s._v(" 加载 "),e("code",[s._v("dataId")]),s._v(" 为 "),e("code",[s._v("example")]),s._v(" 的配置源，并开启自动更新：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@SpringBootApplication\n@NacosPropertySource(dataId = "example", autoRefreshed = true)\npublic class NacosConfigApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(NacosConfigApplication.class, args);\n    }\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("ol",[e("li",[s._v("通过 Nacos 的 "),e("code",[s._v("@NacosValue")]),s._v(" 注解设置属性值。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@Controller\n@RequestMapping("config")\npublic class ConfigController {\n\n    @NacosValue(value = "${useLocalCache:false}", autoRefreshed = true)\n    private boolean useLocalCache;\n\n    @RequestMapping(value = "/get", method = GET)\n    @ResponseBody\n    public boolean get() {\n        return useLocalCache;\n    }\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("ol",[e("li",[s._v("启动 "),e("code",[s._v("NacosConfigApplication")]),s._v("，调用 "),e("code",[s._v("curl http://localhost:8080/config/get")]),s._v("，返回内容是 "),e("code",[s._v("false")]),s._v("。")]),s._v(" "),e("li",[s._v("通过调用 "),e("a",{attrs:{href:"https://nacos.io/zh-cn/docs/open-API.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos Open API"),e("OutboundLink")],1),s._v(" 向 Nacos server 发布配置：dataId 为"),e("code",[s._v("example")]),s._v("，内容为"),e("code",[s._v("useLocalCache=true")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('curl -X POST "http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=example&group=DEFAULT_GROUP&content=useLocalCache=true"\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ol",[e("li",[s._v("再次访问 "),e("code",[s._v("http://localhost:8080/config/get")]),s._v("，此时返回内容为"),e("code",[s._v("true")]),s._v("，说明程序中的"),e("code",[s._v("useLocalCache")]),s._v("值已经被动态更新了。")])]),s._v(" "),e("h2",{attrs:{id:"启动服务发现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动服务发现"}},[s._v("#")]),s._v(" 启动服务发现")]),s._v(" "),e("p",[s._v("本节演示如何在您的 Spring Boot 项目中启动 Nacos 的服务发现功能。完整示例代码请参考："),e("a",{attrs:{href:"https://github.com/nacos-group/nacos-examples/tree/master/nacos-spring-boot-example/nacos-spring-boot-discovery-example",target:"_blank",rel:"noopener noreferrer"}},[s._v("nacos-spring-boot-discovery-example"),e("OutboundLink")],1)]),s._v(" "),e("ol",[e("li",[s._v("添加依赖。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<dependency>\n    <groupId>com.alibaba.boot</groupId>\n    <artifactId>nacos-discovery-spring-boot-starter</artifactId>\n    <version>${latest.version}</version>\n</dependency>\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("strong",[s._v("注意")]),s._v("：版本 "),e("a",{attrs:{href:"https://mvnrepository.com/artifact/com.alibaba.boot/nacos-discovery-spring-boot-starter",target:"_blank",rel:"noopener noreferrer"}},[s._v("0.2.x.RELEASE"),e("OutboundLink")],1),s._v(" 对应的是 Spring Boot 2.x 版本，版本 "),e("a",{attrs:{href:"https://mvnrepository.com/artifact/com.alibaba.boot/nacos-discovery-spring-boot-starter",target:"_blank",rel:"noopener noreferrer"}},[s._v("0.1.x.RELEASE"),e("OutboundLink")],1),s._v(" 对应的是 Spring Boot 1.x 版本。")]),s._v(" "),e("ol",[e("li",[s._v("在 "),e("code",[s._v("application.properties")]),s._v(" 中配置 Nacos server 的地址：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("nacos.discovery.server-addr=127.0.0.1:8848\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ol",[e("li",[s._v("使用 "),e("code",[s._v("@NacosInjected")]),s._v(" 注入 Nacos 的 "),e("code",[s._v("NamingService")]),s._v(" 实例：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@Controller\n@RequestMapping("discovery")\npublic class DiscoveryController {\n\n    @NacosInjected\n    private NamingService namingService;\n\n    @RequestMapping(value = "/get", method = GET)\n    @ResponseBody\n    public List<Instance> get(@RequestParam String serviceName) throws NacosException {\n        return namingService.getAllInstances(serviceName);\n    }\n}\n\n@SpringBootApplication\npublic class NacosDiscoveryApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(NacosDiscoveryApplication.class, args);\n    }\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("ol",[e("li",[s._v("启动 "),e("code",[s._v("NacosDiscoveryApplication")]),s._v("，调用 "),e("code",[s._v("curl http://localhost:8080/discovery/get?serviceName=example")]),s._v("，此时返回为空 JSON 数组"),e("code",[s._v("[]")]),s._v("。")]),s._v(" "),e("li",[s._v("通过调用 "),e("a",{attrs:{href:"https://nacos.io/zh-cn/docs/open-API.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos Open API"),e("OutboundLink")],1),s._v(" 向 Nacos server 注册一个名称为 "),e("code",[s._v("example")]),s._v(" 服务")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("curl -X PUT 'http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=example&ip=127.0.0.1&port=8080'\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ol",[e("li",[s._v("再次访问 "),e("code",[s._v("curl http://localhost:8080/discovery/get?serviceName=example")]),s._v("，此时返回内容为：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[\n  {\n    "instanceId": "127.0.0.1-8080-DEFAULT-example",\n    "ip": "127.0.0.1",\n    "port": 8080,\n    "weight": 1.0,\n    "healthy": true,\n    "cluster": {\n      "serviceName": null,\n      "name": "",\n      "healthChecker": {\n        "type": "TCP"\n      },\n      "defaultPort": 80,\n      "defaultCheckPort": 80,\n      "useIPPort4Check": true,\n      "metadata": {}\n    },\n    "service": null,\n    "metadata": {}\n  }\n]\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("h2",{attrs:{id:"相关项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#相关项目"}},[s._v("#")]),s._v(" 相关项目")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/alibaba/nacos",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/nacos-group/nacos-spring-project",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos Spring"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/nacos-group/nacos-spring-boot-project",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos Spring Boot"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/alibaba/spring-cloud-alibaba",target:"_blank",rel:"noopener noreferrer"}},[s._v("Spring Cloud Alibaba"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);