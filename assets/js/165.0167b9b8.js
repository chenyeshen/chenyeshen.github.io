(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{801:function(e,s,a){"use strict";a.r(s);var t=a(4),n=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("使用Feign调用微服务，传递参数时遇到几个问题")]),e._v(" "),a("h2",{attrs:{id:"_1-无参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-无参数"}},[e._v("#")]),e._v(" 1.无参数")]),e._v(" "),a("p",[e._v("以GET方式请求")]),e._v(" "),a("p",[e._v("服务提供者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/hello")\npublic String Hello(){\n  return "hello,provider";\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("p",[e._v("服务消费者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@GetMapping("/hello")\nString hello();\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h2",{attrs:{id:"_2-单个参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-单个参数"}},[e._v("#")]),e._v(" 2.单个参数")]),e._v(" "),a("p",[e._v("（1）GET——@PathVariable")]),e._v(" "),a("p",[e._v("服务提供者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@GetMapping("/test/{name}")\npublic String test(@PathVariable String name){\n  return "hello,"+name;\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("p",[e._v("服务消费者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@GetMapping("/test/{name}")\nString test(@PathVariable("name") String name);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("（2）GET——@RequestParam")]),e._v(" "),a("p",[e._v("服务提供者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\npublic String test(String name){return "hello,"+name;\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("服务消费者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\nString test(@RequestParam String name);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("会遇到报错")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("RequestParam.value() was empty on parameter 0\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("解决方法：")]),e._v(" "),a("p",[e._v("加上注解的描述，修改为")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\nString test(@RequestParam("name") String name);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("（3）POST")]),e._v(" "),a("p",[e._v("@RequestBody")]),e._v(" "),a("p",[e._v("不需要注解的描述")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\nString test(@RequestBody String name);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("注：")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("参数前使用了@RequestBody注解的，都以POST方式消费服务")])]),e._v(" "),a("li",[a("p",[e._v("@RequestBody注解的参数，需要POST方式才能传递数据")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/image-20201230221800645.png",alt:"image-20201230221800645"}})])])]),e._v(" "),a("h2",{attrs:{id:"_2-feign多参数的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-feign多参数的问题"}},[e._v("#")]),e._v(" 2.Feign多参数的问题")]),e._v(" "),a("p",[e._v("（1）GET——@PathVariable")]),e._v(" "),a("p",[e._v("服务提供者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@GetMapping("/test/{name}/{xyz}")\npublic String test(@PathVariable String name,@PathVariable String xyz){\n    return "hello,"+name+","+xyz;\n}\n\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("p",[e._v("服务消费者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@GetMapping("/test/{name}/{xyz}")\nString test(@PathVariable("name") String name,@PathVariable("xyz") String xyz);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("（1）GET——@RequestParam")]),e._v(" "),a("p",[e._v("服务提供者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\npublic String test(String name,Integer type){\n  if(type==1){\n    return "hello,"+name;\n  }else{\n    return "hello,provider-"+name;\n  }\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br")])]),a("p",[e._v("服务消费者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\nString test(String name, Integer type);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("会遇到报错Method has too many Body parameters")]),e._v(" "),a("p",[e._v("说明：")]),e._v(" "),a("p",[e._v("如果服务消费者传过来参数时，全都用的是@RequestParam的话，那么服务提供者的Controller中对应参数前可以写@RequestParam,也可以不写")]),e._v(" "),a("p",[e._v("服务消费者feign调用时，在所有参数前加上@RequestParam注解")]),e._v(" "),a("p",[e._v("正确的写法")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\nString test(@RequestParam("name") String name, @RequestParam("type") Integer type);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("（2）POST")]),e._v(" "),a("p",[e._v("如果接收方不变")]),e._v(" "),a("p",[e._v("服务消费者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\nString test(@RequestBody String name, @RequestBody Integer type);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("会遇到报错Method has too many Body parameters")]),e._v(" "),a("p",[e._v("服务消费者为")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\nString test(@RequestBody String name, @RequestParam("type") Integer type);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("name的值会为null")]),e._v(" "),a("p",[e._v("说明：")]),e._v(" "),a("p",[e._v("如果服务消费者传过来参数，有@RequestBody的话，那么服务提供者的Controller中对应参数前必须要写@RequestBody")]),e._v(" "),a("p",[e._v("正确的写法")]),e._v(" "),a("p",[e._v("服务提供者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\n  public String test(@RequestBody String name, Integer type){\n    if(type==1){\n      return "hello,"+name;\n    }else{\n      return "hello,provider-"+name;\n    }\n  }\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br")])]),a("p",[e._v("服务消费者正确的写法")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@RequestMapping("/test")\nString test(@RequestBody String name, @RequestParam("type") Integer type);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("可以接收到参数")]),e._v(" "),a("p",[e._v("总结：")]),e._v(" "),a("ul",[a("li",[e._v("请求参数前加上注解@PathVariable、@RequestParam或@RequestBody修饰")]),e._v(" "),a("li",[e._v("可以有多个@RequestParam，但只能有不超过一个@RequestBody")]),e._v(" "),a("li",[e._v("使用@RequestParam注解时必须要在后面加上参数名")]),e._v(" "),a("li",[e._v("@RequestBody用来修饰对象，但是既有@RequestBody也有@RequestParam，那么参数就要放在请求的url中，@RequestBody修饰的就要放在提交对象中")]),e._v(" "),a("li",[e._v("当参数比较复杂时，feign即使声明为get请求也会强行使用post请求")])])])}),[],!1,null,null,null);s.default=n.exports}}]);