(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{816:function(a,s,t){"use strict";t.r(s);var e=t(4),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"安装配置-registry-conf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装配置-registry-conf"}},[a._v("#")]),a._v(" 安装配置 registry.conf")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814100937.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"file-conf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#file-conf"}},[a._v("#")]),a._v(" file.conf")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101003.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101020.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"连接数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#连接数据库"}},[a._v("#")]),a._v(" 连接数据库")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101035.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101049.png",alt:""}})]),a._v(" "),t("p",[t("strong",[a._v("注意mysql 8.0 启动seata有问题 请使用低版本 5.7")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101102.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"启动nacos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动nacos"}},[a._v("#")]),a._v(" 启动nacos")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101121.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"启动seata"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动seata"}},[a._v("#")]),a._v(" 启动seata")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101133.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101151.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"配置pom-xml-加入依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置pom-xml-加入依赖"}},[a._v("#")]),a._v(" 配置pom.xml,加入依赖")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v(" \x3c!-- 分布式事务 --\x3e\n        <dependency>\n            <groupId>io.seata</groupId>\n            <artifactId>seata-spring-boot-starter</artifactId>\n            <version>1.1.0</version>\n        </dependency>\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("h2",{attrs:{id:"配置yml"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置yml"}},[a._v("#")]),a._v(" 配置yml")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("#====================================Seata Config===============================================\nseata:\n  enabled: true\n  application-id: base2020\n  tx-service-group: my_test_tx_group\n  #enable-auto-data-source-proxy: true\n  #use-jdk-proxy: false\n  client:\n    rm:\n      async-commit-buffer-limit: 1000\n      report-retry-count: 5\n      table-meta-check-enable: false\n      report-success-enable: false\n      lock:\n        retry-interval: 10\n        retry-times: 30\n        retry-policy-branch-rollback-on-conflict: true\n    tm:\n      commit-retry-count: 5\n      rollback-retry-count: 5\n    undo:\n      data-validation: true\n      log-serialization: jackson\n      log-table: undo_log\n    log:\n      exceptionRate: 100\n  service:\n    vgroup-mapping:\n      my_test_tx_group: default\n    grouplist:\n      default: 127.0.0.1:8091\n    #enable-degrade: false\n    #disable-global-transaction: false\n  transport:\n    shutdown:\n      wait: 3\n    thread-factory:\n      boss-thread-prefix: NettyBoss\n      worker-thread-prefix: NettyServerNIOWorker\n      server-executor-thread-prefix: NettyServerBizHandler\n      share-boss-worker: false\n      client-selector-thread-prefix: NettyClientSelector\n      client-selector-thread-size: 1\n      client-worker-thread-prefix: NettyClientWorkerThread\n      worker-thread-size: default\n      boss-thread-size: 1\n    type: TCP\n    server: NIO\n    heartbeat: true\n    serialization: seata\n    compressor: none\n    enable-client-batch-send-request: true\n   \n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br"),t("span",{staticClass:"line-number"},[a._v("23")]),t("br"),t("span",{staticClass:"line-number"},[a._v("24")]),t("br"),t("span",{staticClass:"line-number"},[a._v("25")]),t("br"),t("span",{staticClass:"line-number"},[a._v("26")]),t("br"),t("span",{staticClass:"line-number"},[a._v("27")]),t("br"),t("span",{staticClass:"line-number"},[a._v("28")]),t("br"),t("span",{staticClass:"line-number"},[a._v("29")]),t("br"),t("span",{staticClass:"line-number"},[a._v("30")]),t("br"),t("span",{staticClass:"line-number"},[a._v("31")]),t("br"),t("span",{staticClass:"line-number"},[a._v("32")]),t("br"),t("span",{staticClass:"line-number"},[a._v("33")]),t("br"),t("span",{staticClass:"line-number"},[a._v("34")]),t("br"),t("span",{staticClass:"line-number"},[a._v("35")]),t("br"),t("span",{staticClass:"line-number"},[a._v("36")]),t("br"),t("span",{staticClass:"line-number"},[a._v("37")]),t("br"),t("span",{staticClass:"line-number"},[a._v("38")]),t("br"),t("span",{staticClass:"line-number"},[a._v("39")]),t("br"),t("span",{staticClass:"line-number"},[a._v("40")]),t("br"),t("span",{staticClass:"line-number"},[a._v("41")]),t("br"),t("span",{staticClass:"line-number"},[a._v("42")]),t("br"),t("span",{staticClass:"line-number"},[a._v("43")]),t("br"),t("span",{staticClass:"line-number"},[a._v("44")]),t("br"),t("span",{staticClass:"line-number"},[a._v("45")]),t("br"),t("span",{staticClass:"line-number"},[a._v("46")]),t("br"),t("span",{staticClass:"line-number"},[a._v("47")]),t("br"),t("span",{staticClass:"line-number"},[a._v("48")]),t("br"),t("span",{staticClass:"line-number"},[a._v("49")]),t("br"),t("span",{staticClass:"line-number"},[a._v("50")]),t("br"),t("span",{staticClass:"line-number"},[a._v("51")]),t("br"),t("span",{staticClass:"line-number"},[a._v("52")]),t("br"),t("span",{staticClass:"line-number"},[a._v("53")]),t("br")])]),t("h2",{attrs:{id:"复制seata-配置文件到springboot资源文件目录下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#复制seata-配置文件到springboot资源文件目录下"}},[a._v("#")]),a._v(" 复制seata 配置文件到springboot资源文件目录下")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101223.png",alt:""}})]),a._v(" "),t("p",[a._v("然后进入业务异常提示")]),a._v(" "),t("p",[a._v('方法上加入@GlobalTransactional(timeoutMills = 300000, name = "base2020-seata-example")')]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('@GlobalTransactional(timeoutMills = 300000, name = "base2020-seata-example")\n    public void save(Notice bean) {\n         dao.saveEntity(bean);\n         throw new RuntimeException("notice branch exception");//看是否成功\n    }\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("p",[a._v("ok 提交数据测试")]),a._v(" "),t("h2",{attrs:{id:"创建undo表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建undo表"}},[a._v("#")]),a._v(" 创建undo表")]),a._v(" "),t("p",[a._v("每个业务都需要执行事务  比如订单数据库   库存数据库  分别都执行db_udo_log.sql   创建undo表")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101236.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/daixiaomao/Images/raw/master/img/20200814101249.png",alt:""}})])])}),[],!1,null,null,null);s.default=n.exports}}]);